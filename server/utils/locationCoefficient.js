/**
 * 全国城市位置系数映射表
 * 用于计算房产避险加成
 * 
 * 位置系数规则：
 * - 1.5-2.0：极度安全（深山、偏远、距离台湾>2000km）
 * - 1.2-1.5：高度安全（内陆、距离台湾>1500km）
 * - 1.0-1.2：中等安全（内陆、距离台湾>1000km）
 * - 0.8-1.0：相对安全（近内陆、距离台湾>500km）
 * - 0.5-0.8：较低安全（沿海、距离台湾<500km）
 */

// 全国城市位置系数映射表
export const LOCATION_COEFFICIENT_MAP = {
  // ========== 西北地区（最安全，距离台湾最远）==========
  // 新疆
  "乌鲁木齐": 2.0, "克拉玛依": 2.0, "石河子": 2.0, "伊宁": 2.0, "库尔勒": 2.0, "喀什": 2.0,
  "阿克苏": 2.0, "哈密": 2.0, "昌吉": 2.0, "奎屯": 2.0,
  
  // 西藏
  "拉萨": 2.0, "日喀则": 2.0, "林芝": 2.0, "昌都": 2.0, "那曲": 2.0, "山南": 2.0,
  
  // 青海
  "西宁": 1.8, "格尔木": 2.0, "德令哈": 2.0, "海东": 1.8,
  
  // 甘肃
  "兰州": 1.8, "天水": 1.7, "酒泉": 2.0, "张掖": 1.9, "武威": 1.8, "平凉": 1.7,
  "庆阳": 1.7, "定西": 1.7, "陇南": 1.6, "嘉峪关": 1.9,
  
  // 宁夏
  "银川": 1.7, "石嘴山": 1.7, "吴忠": 1.7, "固原": 1.8, "中卫": 1.7,
  
  // 内蒙古
  "呼和浩特": 1.6, "包头": 1.6, "赤峰": 1.5, "通辽": 1.5, "鄂尔多斯": 1.7,
  "呼伦贝尔": 1.8, "巴彦淖尔": 1.7, "乌兰察布": 1.6, "锡林郭勒": 1.8,
  
  // ========== 西南地区（高度安全）==========
  // 四川
  "成都": 1.4, "绵阳": 1.4, "德阳": 1.4, "南充": 1.3, "宜宾": 1.3, "自贡": 1.3,
  "乐山": 1.3, "泸州": 1.3, "达州": 1.4, "内江": 1.3, "遂宁": 1.3, "攀枝花": 1.6,
  "眉山": 1.3, "广安": 1.3, "资阳": 1.3, "凉山": 1.7, "甘孜": 1.9, "阿坝": 1.9,
  
  // 云南
  "昆明": 1.5, "曲靖": 1.5, "玉溪": 1.4, "大理": 1.6, "丽江": 1.7, "保山": 1.6,
  "昭通": 1.5, "普洱": 1.6, "临沧": 1.6, "楚雄": 1.5, "红河": 1.5, "文山": 1.4,
  "西双版纳": 1.5, "德宏": 1.6, "怒江": 1.8, "迪庆": 1.9,
  
  // 贵州
  "贵阳": 1.4, "遵义": 1.4, "六盘水": 1.5, "安顺": 1.4, "毕节": 1.5, "铜仁": 1.4,
  "黔西南": 1.5, "黔东南": 1.5, "黔南": 1.4,
  
  // 重庆
  "重庆": 1.3, "万州": 1.3, "涪陵": 1.3, "永川": 1.3, "合川": 1.3, "江津": 1.3,
  
  // ========== 华中地区（中等安全）==========
  // 陕西
  "西安": 1.2, "咸阳": 1.1, "宝鸡": 1.2, "渭南": 1.1, "汉中": 1.3, "安康": 1.2,
  "商洛": 1.5, "延安": 1.4, "榆林": 1.5, "铜川": 1.2,
  
  // 河南
  "郑州": 1.1, "洛阳": 1.1, "开封": 1.0, "平顶山": 1.1, "安阳": 1.0, "鹤壁": 1.0,
  "新乡": 1.0, "焦作": 1.0, "濮阳": 1.0, "许昌": 1.0, "漯河": 1.0, "三门峡": 1.2,
  "南阳": 1.1, "商丘": 1.0, "信阳": 1.0, "周口": 1.0, "驻马店": 1.0, "济源": 1.1,
  
  // 湖北
  "武汉": 1.0, "黄石": 0.9, "十堰": 1.2, "宜昌": 1.1, "襄阳": 1.1, "鄂州": 0.9,
  "荆门": 1.0, "孝感": 1.0, "荆州": 1.0, "黄冈": 1.0, "咸宁": 1.0, "随州": 1.0,
  "恩施": 1.3, "仙桃": 0.9, "潜江": 0.9, "天门": 0.9, "神农架": 1.6,
  
  // 湖南
  "长沙": 1.0, "株洲": 1.0, "湘潭": 1.0, "衡阳": 1.0, "邵阳": 1.1, "岳阳": 0.9,
  "常德": 1.0, "张家界": 1.2, "益阳": 1.0, "郴州": 1.0, "永州": 1.0, "怀化": 1.1,
  "娄底": 1.0, "湘西": 1.3,
  
  // 江西
  "南昌": 0.9, "景德镇": 0.9, "萍乡": 0.9, "九江": 0.8, "新余": 0.9, "鹰潭": 0.9,
  "赣州": 1.0, "吉安": 1.0, "宜春": 0.9, "抚州": 0.9, "上饶": 0.8,
  
  // ========== 华北地区（中等安全）==========
  // 北京
  "北京": 1.0, "通州": 1.0, "昌平": 1.0, "大兴": 1.0, "房山": 1.0, "顺义": 1.0,
  "怀柔": 1.1, "密云": 1.1, "延庆": 1.2, "平谷": 1.1,
  
  // 天津
  "天津": 0.9, "滨海新区": 0.8, "和平": 0.9, "河东": 0.9, "河西": 0.9, "南开": 0.9,
  "河北": 0.9, "红桥": 0.9, "东丽": 0.9, "西青": 0.9, "津南": 0.9, "北辰": 0.9,
  "武清": 0.9, "宝坻": 0.9, "宁河": 0.9, "静海": 0.9, "蓟州": 1.0,
  
  // 河北
  "石家庄": 1.0, "唐山": 0.9, "秦皇岛": 0.8, "邯郸": 1.0, "邢台": 1.0, "保定": 1.0,
  "张家口": 1.3, "承德": 1.2, "沧州": 0.9, "廊坊": 0.9, "衡水": 1.0,
  
  // 山西
  "太原": 1.2, "大同": 1.3, "阳泉": 1.1, "长治": 1.2, "晋城": 1.2, "朔州": 1.3,
  "晋中": 1.2, "运城": 1.1, "忻州": 1.3, "临汾": 1.2, "吕梁": 1.3,
  
  // 山东
  "济南": 1.0, "青岛": 0.8, "淄博": 0.9, "枣庄": 0.9, "东营": 0.8, "烟台": 0.8,
  "潍坊": 0.9, "济宁": 1.0, "泰安": 1.0, "威海": 0.8, "日照": 0.8, "临沂": 0.9,
  "德州": 1.0, "聊城": 1.0, "滨州": 0.9, "菏泽": 1.0,
  
  // ========== 东北地区（中等安全）==========
  // 黑龙江
  "哈尔滨": 1.3, "齐齐哈尔": 1.4, "鸡西": 1.2, "鹤岗": 1.2, "双鸭山": 1.2, "大庆": 1.3,
  "伊春": 1.5, "佳木斯": 1.2, "七台河": 1.2, "牡丹江": 1.2, "黑河": 1.5, "绥化": 1.3,
  "大兴安岭": 1.8,
  
  // 吉林
  "长春": 1.2, "吉林": 1.2, "四平": 1.2, "辽源": 1.2, "通化": 1.2, "白山": 1.4,
  "松原": 1.3, "白城": 1.3, "延边": 1.3,
  
  // 辽宁
  "沈阳": 1.1, "大连": 0.8, "鞍山": 1.0, "抚顺": 1.1, "本溪": 1.1, "丹东": 0.8,
  "锦州": 0.9, "营口": 0.8, "阜新": 1.1, "辽阳": 1.0, "盘锦": 0.9, "铁岭": 1.1,
  "朝阳": 1.2, "葫芦岛": 0.9,
  
  // ========== 华东地区（相对安全）==========
  // 上海
  "上海": 0.7, "黄浦": 0.7, "徐汇": 0.7, "长宁": 0.7, "静安": 0.7, "普陀": 0.7,
  "虹口": 0.7, "杨浦": 0.7, "闵行": 0.7, "宝山": 0.7, "嘉定": 0.7, "浦东": 0.7,
  "金山": 0.7, "松江": 0.7, "青浦": 0.7, "奉贤": 0.7, "崇明": 0.8,
  
  // 江苏
  "南京": 0.9, "无锡": 0.8, "徐州": 1.0, "常州": 0.8, "苏州": 0.8, "南通": 0.8,
  "连云港": 0.8, "淮安": 0.9, "盐城": 0.8, "扬州": 0.9, "镇江": 0.9, "泰州": 0.8,
  "宿迁": 0.9,
  
  // 浙江
  "杭州": 0.8, "宁波": 0.7, "温州": 0.7, "嘉兴": 0.7, "湖州": 0.8, "绍兴": 0.8,
  "金华": 0.8, "衢州": 0.9, "舟山": 0.6, "台州": 0.7, "丽水": 1.0,
  
  // 安徽
  "合肥": 0.9, "芜湖": 0.8, "蚌埠": 0.9, "淮南": 0.9, "马鞍山": 0.8, "淮北": 0.9,
  "铜陵": 0.8, "安庆": 0.9, "黄山": 1.0, "滁州": 0.9, "阜阳": 1.0, "宿州": 0.9,
  "六安": 1.0, "亳州": 1.0, "池州": 0.9, "宣城": 0.9,
  
  // 福建
  "福州": 0.6, "厦门": 0.5, "莆田": 0.6, "三明": 0.8, "泉州": 0.6, "漳州": 0.6,
  "南平": 0.9, "龙岩": 0.8, "宁德": 0.7,
  
  // ========== 华南地区（较低安全，距离台湾较近）==========
  // 广东
  "广州": 0.7, "韶关": 0.8, "深圳": 0.6, "珠海": 0.5, "汕头": 0.6, "佛山": 0.7,
  "江门": 0.6, "湛江": 0.7, "茂名": 0.7, "肇庆": 0.8, "惠州": 0.7, "梅州": 0.8,
  "汕尾": 0.6, "河源": 0.8, "阳江": 0.7, "清远": 0.8, "东莞": 0.7, "中山": 0.6,
  "潮州": 0.6, "揭阳": 0.6, "云浮": 0.8,
  
  // 广西
  "南宁": 0.9, "柳州": 0.9, "桂林": 1.0, "梧州": 0.8, "北海": 0.7, "防城港": 0.6,
  "钦州": 0.7, "贵港": 0.9, "玉林": 0.8, "百色": 1.1, "贺州": 0.9, "河池": 1.0,
  "来宾": 0.9, "崇左": 0.9,
  
  // 海南
  "海口": 0.7, "三亚": 0.6, "三沙": 0.5, "儋州": 0.7, "五指山": 0.8, "琼海": 0.7,
  "文昌": 0.7, "万宁": 0.7, "东方": 0.7, "定安": 0.7, "屯昌": 0.7, "澄迈": 0.7,
  "临高": 0.7, "白沙": 0.8, "昌江": 0.7, "乐东": 0.7, "陵水": 0.7, "保亭": 0.8,
  "琼中": 0.8,
};

/**
 * 根据城市名称获取位置系数
 * @param {string} cityName - 城市名称
 * @returns {number} 位置系数（0.5-2.0）
 */
export const getLocationCoefficient = (cityName) => {
  if (!cityName) return 1.0; // 默认值
  
  // 直接匹配
  if (LOCATION_COEFFICIENT_MAP[cityName]) {
    return LOCATION_COEFFICIENT_MAP[cityName];
  }
  
  // 模糊匹配（包含城市名）
  for (const [city, coefficient] of Object.entries(LOCATION_COEFFICIENT_MAP)) {
    if (cityName.includes(city) || city.includes(cityName)) {
      return coefficient;
    }
  }
  
  // 根据省份判断（如果城市名包含省份）
  const provinceMap = {
    "新疆": 2.0, "西藏": 2.0, "青海": 1.8, "甘肃": 1.8, "宁夏": 1.7, "内蒙古": 1.6,
    "四川": 1.4, "云南": 1.5, "贵州": 1.4, "重庆": 1.3,
    "陕西": 1.2, "河南": 1.0, "湖北": 1.0, "湖南": 1.0, "江西": 0.9,
    "北京": 1.0, "天津": 0.9, "河北": 1.0, "山西": 1.2, "山东": 0.9,
    "黑龙江": 1.3, "吉林": 1.2, "辽宁": 1.0,
    "上海": 0.7, "江苏": 0.8, "浙江": 0.8, "安徽": 0.9, "福建": 0.6,
    "广东": 0.7, "广西": 0.9, "海南": 0.7
  };
  
  for (const [province, coefficient] of Object.entries(provinceMap)) {
    if (cityName.includes(province)) {
      return coefficient;
    }
  }
  
  // 默认值：根据是否包含"省"、"市"等关键词判断
  if (cityName.includes("省") || cityName.includes("自治区")) {
    return 1.2; // 内陆省份默认值
  }
  
  return 1.0; // 最终默认值
};

/**
 * 根据位置系数获取安全等级描述
 * @param {number} coefficient - 位置系数
 * @returns {string} 安全等级描述
 */
export const getSafetyLevel = (coefficient) => {
  if (coefficient >= 1.8) return "極度安全（深山/偏遠）";
  if (coefficient >= 1.5) return "高度安全（內陸深處）";
  if (coefficient >= 1.2) return "中等安全（內陸）";
  if (coefficient >= 1.0) return "相對安全（近內陸）";
  if (coefficient >= 0.8) return "一般安全（沿海內側）";
  return "較低安全（沿海）";
};

/**
 * 根据城市名称获取战区代码（用于资产包装）
 * @param {string} cityName - 城市名称
 * @returns {string} 战区代码
 */
export const getSectorCode = (cityName) => {
  const coefficient = getLocationCoefficient(cityName);
  
  if (coefficient >= 1.8) return "CN-NW-ULTRA"; // 极度安全
  if (coefficient >= 1.5) return "CN-NW-DEEP";  // 深度内陆
  if (coefficient >= 1.2) return "CN-INT-RES";   // 内陆储备
  if (coefficient >= 1.0) return "CN-INT-SUB";   // 内陆近郊
  if (coefficient >= 0.8) return "CN-COAST-IN";  // 沿海内侧
  return "CN-COAST"; // 沿海
};

